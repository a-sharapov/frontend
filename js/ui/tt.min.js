!function(){var a=$('<div id="galleryOverlay">'),b=$('<div id="gallerySlider">'),c=$('<a id="prevArrow"></a>'),d=$('<a id="nextArrow"></a>'),e=!1;$.fn.touchTouch=function(){function f(b){return!e&&(a.show(),setTimeout(function(){a.addClass("visible").trigger("TToverlayShow")},100),h(b),void(e=!0))}function g(){return!!e&&(a.hide().removeClass("visible").trigger("TToverlayHide"),e=!1,$(".placeholder").empty(),void(q=p))}function h(a){b.css("left",100*-a+"%")}function i(a){setTimeout(function(){j(a)},1e3)}function j(a){return!(a<0||a>=q.length)&&void k(q.eq(a).attr("href"),function(){n.eq(a).html(this)})}function k(a,b){var c=$("<img>").on("load",function(){b.call(c),c.parent().append('<a class="view-zoomed" href="'+a+'" target="_blank">Оригинал</a>')});c.attr("src",a)}function l(){o+1<q.length?(o++,h(o),i(o+1)):(b.addClass("rightSpring"),setTimeout(function(){b.removeClass("rightSpring")},500))}function m(){o>0?(o--,h(o),i(o-1)):(b.addClass("leftSpring"),setTimeout(function(){b.removeClass("leftSpring")},500))}var n=$([]),o=0,p=this,q=p;a.hide().appendTo("body"),b.appendTo(a),q.each(function(){n=n.add($('<div class="placeholder">'))}),b.append(n).on("click",function(a){$(a.target).is("img")||g()}),$("body").on("touchstart","#gallerySlider img",function(a){var c=a.originalEvent,d=c.changedTouches[0].pageX;return b.on("touchmove",function(a){a.preventDefault(),c=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0],c.pageX-d>10?(b.off("touchmove"),m()):c.pageX-d<-10&&(b.off("touchmove"),l())}),!1}).on("touchend",function(){b.off("touchmove")}),q.on("click",function(a){a.preventDefault();var b,c,d=$(this),e=d.parent().closest("[data-gallery]");d.attr("data-gallery")?(b=d.attr("data-gallery"),c="item"):e.length&&(b=e.attr("data-gallery"),c="ancestor"),b&&"item"==c?q=$("[data-gallery="+b+"]"):b&&"ancestor"==c&&(q=q.filter(function(){return $(this).parent().closest("[data-gallery]").length})),o=q.index(this),f(o),j(o),i(o+1),i(o-1)}),"ontouchstart"in window||(a.append(c).append(d),c.click(function(a){a.preventDefault(),m()}),d.click(function(a){a.preventDefault(),l()})),$(window).bind("keydown",function(a){37==a.keyCode?m():39==a.keyCode?l():27==a.keyCode&&g()})}}(jQuery);